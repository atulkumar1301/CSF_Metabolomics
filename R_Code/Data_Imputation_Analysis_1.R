library(data.table)
library(mice)
library (ggmice)
df <- fread ("/Volumes/ATUL_6TB/Work/Projects/CSF_Metabolomics/Analyses_1/3_Data_Missing_Value.txt")

###Remove Columns with all missing values
#df_1 <- subset (df, select = -c(A_136, A_197, A_302, A_342, A_356, A_848, A_881, A_1082, A_1123, A_1383, A_1388, A_1487, A_1869, A_2028, A_2048, A_2049, A_100000043, A_100000463, A_100000579, A_100000687, A_100000843, A_100000984, A_100001086, A_100001148, A_100001212, A_100001251, A_100001309, A_100001385, A_100001386, A_100001399, A_100001400, A_100001538, A_100001632, A_100001788, A_100001791, A_100001793, A_100001795, A_100001859, A_100001933, A_100002122, A_100002144, A_100002321, A_100002322, A_100002405, A_100002454, A_100002489, A_100002500, A_100002717, A_100002719, A_100002725, A_100002726, A_100002734, A_100002806, A_100002807, A_100002809, A_100002849, A_100003441, A_100003444, A_100003473, A_100004111, A_100004112, A_100004169, A_100004171, A_100004173, A_100004175, A_100004318, A_100004396, A_100004509, A_100004518, A_100004542, A_100005367, A_100006116, A_100006129, A_100006191, A_100006203, A_100006229, A_100006360, A_100006375, A_100006381, A_100006382, A_100006383, A_100008964, A_100009034, A_100009253, A_100009254, A_100009390, A_100015873, A_100015965, A_100015972, A_100015982, A_100020014, A_100020409, A_100020417, A_100020536, A_100020546, A_100020811, A_100020827, A_100020837, A_100020881, A_100020909, A_100020915, A_100020918, A_100020973, A_100020975, A_100021782, A_100022475, A_999911299, A_999912407, A_999912740, A_999912816, A_999912844, A_999917353, A_999917355, A_999919183, A_999921258, A_999921442, A_999921752, A_999921803, A_999923276, A_999923666, A_999925217, A_999925271, A_999925279, A_999925468, A_999925957, A_999926062, A_999926111))
df_1 <- subset (df, select = c(A_98, A_339, A_501, A_825, A_935, A_100000096, A_100001175, A_100001256, A_100001992, A_100006092, A_100006614, A_100008992, A_100021728, A_999912026, A_999915245))
###Imputation of the missing data

imp.mice <- mice(df_1, defaultMethod = "cart")
imp.mice_1 <- complete (imp.mice)
write.table (imp.mice_1, file = paste0 ("/Volumes/ATUL_6TB/Work/Projects/CSF_Metabolomics/Analyses_1/Data_Imputed_Analysis_1.txt"), sep="\t", quote=FALSE, row.names=FALSE, col.names=TRUE)
#imp.mice_2 <- mice(df_1, defaultMethod = "rf")
imp.mice_3 <- complete (imp.mice_2)


#write.table (imp.mice_2, file = paste0 ("/Volumes/ATUL_6TB/Work/Projects/CSF_Metabolomics/Analyses_1/Data_Imputed_Analysis_1_RF.txt"), sep="\t", quote=FALSE, row.names=FALSE, col.names=TRUE)

densityplot(imp.mice, ~ A_98 + A_339 + A_501 + A_825 + A_935 + A_100000096 + A_100001175 + A_100001256 + A_100001992 + A_100006092 + A_100006614 + A_100008992 + A_100021728 + A_999912026 + A_999915245)
bwplot(imp.mice)
